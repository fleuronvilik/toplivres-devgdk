<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <!-- put this at the TOP of <head> on every shell -->
    <style id="preload-guard">html{opacity:0}</style>
    <script>
    (function(){
      try{
        var t = localStorage.getItem('token');
        var role = t ? JSON.parse(atob(t.split('.')[1])).role : null;
        var p = location.pathname;
        if (role==='admin' && p === '/') { location.replace('/admin'); return; }
        if (role==='customer' && (p === '/admin' || p.startsWith('/users/'))) { location.replace('/'); return; }
      }catch(e){}
      var s=document.getElementById('preload-guard'); if(s) s.remove();
    })();
    </script>

    <title>{% block title %}{% endblock %}</title>
    <script type="module" src="{{ url_for('static', filename='js/app.js') }}" defer></script>
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>

  <body>
    <main class="container">
        <div id="login-section">
            <form id="loginForm" class="card">
                <label>Email: <input type="email" name="email" required></label>
                <label>Password: <input type="password" name="password" required></label>
                <button type="submit" class="btn btn-submit">Login</button>
            </form>
        </div>
        {% block content %}{% endblock %}
    </main>
    <!--
    <div id="content"></div>
    <div id="footer">
      {% block footer %}
      &copy; Copyright 2010 by <a href="http://domain.invalid/">you</a>.
      {% endblock %}
    </div>
    -->
  </body>
</html>
